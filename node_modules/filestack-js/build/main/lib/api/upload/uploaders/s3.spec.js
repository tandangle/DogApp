"use strict";
/*
 * Copyright (c) 2019 by Filestack.
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var s3_1 = require("./s3");
var file_1 = require("./../file");
var nock = require("nock");
var abstract_1 = require("./abstract");
var utils = require("../../../utils");
var testBufferSize = 1024 * 1024 * 9;
var testSmallBufferSize = 1024 * 1024 * 2;
var testBuff = Buffer.alloc(testBufferSize).fill('t', 0, testBufferSize);
var smallTestBuff = Buffer.alloc(testSmallBufferSize).fill('t', 0, testSmallBufferSize);
var scope;
var interceptorS3;
var interceptorStart;
var interceptorCommit;
var interceptorUpload;
var interceptorComplete;
var getTestFile = function () {
    return new file_1.File({
        slice: function (start, end) { return Promise.resolve(testBuff.slice(start, end)); },
        type: 'text/plain',
        // @ts-ignore
        size: testBuff.length,
        name: 'test.txt',
    });
};
var getSmallTestFile = function () {
    return new file_1.File({
        slice: function (start, end) { return Promise.resolve(testBuff.slice(start, end)); },
        type: 'text/plain',
        // @ts-ignore
        size: smallTestBuff.length,
        name: 'test.txt',
    });
};
var getNullSizeFile = function () {
    return new file_1.File({
        slice: function (start, end) { return Promise.resolve(testBuff.slice(start, end)); },
        type: 'text/plain',
        // @ts-ignore
        size: 0,
        name: 'test.txt',
    });
};
var testApikey = 'testapikey';
var testHost = 'https://filestack-test.com';
var mockUploadId = '123132123';
var mockRegion = 'test-region';
var mockedUri = '/sometest';
var s3Url = testHost + '/fakes3';
var mockStart = jest.fn().mockName('multipart/start');
var mockUpload = jest.fn().mockName('multipart/upload');
var mockPut = jest.fn().mockName('s3/put');
var mockCommit = jest.fn().mockName('multipart/commit');
var mockComplete = jest.fn().mockName('multipart/complete');
var s3Callback = function (url) {
    return mockPut(url, this.req.headers);
};
describe('Api/Upload/Uploaders/S3', function () {
    beforeEach(function () {
        scope = nock(testHost);
        // scope.defaultReplyHeaders({ 'access-control-allow-origin': '*', 'content-type': 'application/json' });
        scope.persist();
        interceptorStart = scope.post('/multipart/start');
        interceptorUpload = scope.post('/multipart/upload');
        interceptorCommit = scope.post('/multipart/commit');
        interceptorComplete = scope.post('/multipart/complete');
        interceptorS3 = scope.put('/fakes3');
        interceptorStart.reply(200, function (_, data) { return mockStart(data); });
        interceptorUpload.twice().reply(200, function (_, data) { return mockUpload(data); });
        interceptorCommit.reply(200, function (_, data) { return mockCommit(data); });
        interceptorComplete.reply(200, function (_, data) { return mockComplete(data); });
        interceptorS3.twice().reply(201, s3Callback, { etag: 'test' });
        mockStart.mockReturnValue({
            uri: mockedUri,
            region: mockRegion,
            upload_id: mockUploadId,
            location_url: testHost,
        });
        mockUpload.mockReturnValue({
            url: s3Url,
            headers: {
                test: 'test',
            },
            location_url: testHost,
        });
        mockPut.mockReturnValue({});
        mockCommit.mockReturnValue({});
        mockComplete.mockReturnValue({
            handle: 'test_handle',
            url: 'test_url',
            filename: 'test_filename',
            size: 123,
            mimetype: 'test_mimetype',
            status: 'test_status',
            upload_tags: { test: 123 },
        });
    });
    afterEach(function () {
        nock.cleanAll();
        nock.enableNetConnect();
        jest.clearAllMocks();
    });
    describe('Standart tests', function () {
        it('should initialize class without errors', function () {
            expect(function () {
                var u = new s3_1.S3Uploader({});
                var uu = new s3_1.S3Uploader({}, 10);
            }).not.toThrowError();
        });
        it('should allow adding files', function () {
            var u = new s3_1.S3Uploader({});
            u.addFile(getTestFile());
        });
        it('should not allow to set min part size lower than defined', function () {
            var u = new s3_1.S3Uploader({});
            expect(function () { return u.setPartSize(10); }).toThrowError();
        });
        it('should throw an error when setting to small intelligent chunk size', function () {
            var u = new s3_1.S3Uploader({});
            expect(function () { return u.setIntelligentChunkSize(10); }).toThrowError();
        });
        it('should throw an error when trying to get host when it is undefined', function () {
            var u = new s3_1.S3Uploader({});
            expect(function () { return u.getUrl(); }).toThrowError();
        });
        it('should set intelligent mobile chunk size on mobile devices', function () {
            spyOn(utils, 'isMobile').and.returnValue(true);
            var u = new s3_1.S3Uploader({});
            return expect(u.getIntelligentChunkSize()).toEqual(abstract_1.INTELLIGENT_MOBILE_CHUNK_SIZE);
        });
        it('should allow to set part size on other mode thant regular', function () {
            var u = new s3_1.S3Uploader({});
            u.setUploadMode("intelligent" /* INTELLIGENT */);
            var partSize = 1024 * 1024;
            u.setPartSize(partSize);
            expect(u.getPartSize()).toEqual(abstract_1.DEFAULT_PART_SIZE);
        });
        it('should retry complete request on 202 status code', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var mock202, u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mock202 = jest
                            .fn()
                            .mockName('202 mock')
                            .mockReturnValue('');
                        nock.removeInterceptor(interceptorComplete);
                        scope.persist(false);
                        scope.post('/multipart/complete').reply(202, function () { return mock202(); });
                        scope.post('/multipart/complete').reply(200, function (_, data) { return mockComplete(data); });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        expect(mock202).toHaveBeenCalledTimes(1);
                        expect(mockComplete).toHaveBeenCalledTimes(1);
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect provided store options', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var storeOption, u;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        storeOption = {
                            container: 'test',
                            location: abstract_1.DEFAULT_STORE_LOCATION,
                            workflows: [{
                                    id: 'test',
                                }],
                        };
                        u = new s3_1.S3Uploader(storeOption);
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        _a.sent();
                        expect(mockStart).toHaveBeenCalledWith(expect.objectContaining({ store: storeOption }));
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining({ store: storeOption }));
                        return [2 /*return*/];
                }
            });
        }); });
        it('should add https protocol to location_url', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mockStart.mockReturnValue({
                            uri: mockedUri,
                            region: mockRegion,
                            upload_id: mockUploadId,
                            location_url: testHost.replace('https://', ''),
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        expect(mockPut).toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should throw error on file size 0', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mockStart.mockReturnValue({
                            uri: mockedUri,
                            region: mockRegion,
                            upload_id: mockUploadId,
                            location_url: testHost.replace('https://', ''),
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getNullSizeFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('Failed');
                        expect(mockStart).not.toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should throw error on wrong etag field', function (done) { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mockStart.mockReturnValue({
                            uri: mockedUri,
                            region: mockRegion,
                            upload_id: mockUploadId,
                            location_url: testHost.replace('https://', ''),
                        });
                        interceptorS3.once().reply(200, s3Callback, {});
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        u.on('error', function (err) {
                            expect(err.message).toEqual('Cannot upload file, check S3 bucket settings');
                            done();
                        });
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should add Filestack-Upload-Region header on location_region param', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res, testFile, firstPartMetadata, firstPartChunk;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mockStart.mockReturnValue({
                            uri: mockedUri,
                            region: mockRegion,
                            upload_id: mockUploadId,
                            location_region: 'test',
                            location_url: testHost.replace('https://', ''),
                        });
                        interceptorUpload.reply(200, function (_, data) {
                            return mockUpload(data, this.req.headers);
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        testFile = getSmallTestFile();
                        firstPartMetadata = testFile.getPartMetadata(0, abstract_1.DEFAULT_PART_SIZE);
                        return [4 /*yield*/, testFile.getPartByMetadata(firstPartMetadata)];
                    case 2:
                        firstPartChunk = _a.sent();
                        expect(mockUpload).toHaveBeenCalledWith({
                            md5: firstPartChunk.md5,
                            size: testFile.size,
                            apikey: testApikey,
                            region: mockRegion,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                            upload_id: mockUploadId,
                            part: 1,
                        }, expect.objectContaining({ 'filestack-upload-region': 'test' }));
                        expect(mockPut).toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect pause() and resume() command', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getTestFile());
                        setImmediate(function () { return u.pause(); });
                        setTimeout(function () { return u.resume(); }, 10);
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect abort() command', function (done) {
            var u = new s3_1.S3Uploader({});
            u.setUrl(testHost);
            u.setApikey(testApikey);
            u.addFile(getTestFile());
            setImmediate(function () { return u.abort(); });
            u.execute().then(function (res) {
                expect(res[0].status).toEqual('Failed');
                done();
            }).catch(function () {
                done('Execution failed');
            });
        });
        it('should send correct security', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var testSecurity, u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        testSecurity = {
                            policy: 'test_p',
                            signature: 'test_s',
                        };
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.setSecurity(testSecurity);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        expect(mockStart).toHaveBeenCalledWith(expect.objectContaining(testSecurity));
                        expect(mockUpload).toHaveBeenCalledWith(expect.objectContaining(testSecurity));
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining(testSecurity));
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect disableStorageKey option', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res, storageKeyExpect;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        u = new s3_1.S3Uploader({
                            disableStorageKey: true,
                            path: '/test/',
                        });
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        storageKeyExpect = {
                            store: {
                                location: 's3',
                                path: '/test/test.txt',
                            },
                        };
                        expect(mockStart).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockUpload).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect disableStorageKey option when path is missing', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res, storageKeyExpect;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        u = new s3_1.S3Uploader({
                            disableStorageKey: true,
                        });
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        storageKeyExpect = {
                            store: {
                                location: 's3',
                                path: '/test.txt',
                            },
                        };
                        expect(mockStart).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockUpload).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        return [2 /*return*/];
                }
            });
        }); });
        it('should respect disableStorageKey option when path has missing /', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res, storageKeyExpect;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        u = new s3_1.S3Uploader({
                            disableStorageKey: true,
                            path: '/test',
                        });
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        storageKeyExpect = {
                            store: {
                                location: 's3',
                                path: '/test/test.txt',
                            },
                        };
                        expect(mockStart).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockUpload).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining(storageKeyExpect));
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe('Tags', function () {
        it('Make correct request with upload tags', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, tags, res, tagsExpected;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        u = new s3_1.S3Uploader({
                            disableStorageKey: true,
                            path: '/test',
                        });
                        tags = {
                            test: '123',
                            test2: 'test',
                        };
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        u.setUploadTags(tags);
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        tagsExpected = {
                            upload_tags: tags,
                        };
                        expect(res[0].uploadTags).toEqual({ test: 123 });
                        expect(mockComplete).toHaveBeenCalledWith(expect.objectContaining(tagsExpected));
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe('Upload modes', function () {
        describe('Intelligent ingession', function () {
            beforeEach(function () {
                mockStart.mockReturnValue({
                    uri: mockedUri,
                    region: mockRegion,
                    upload_id: mockUploadId,
                    location_url: testHost,
                    upload_type: 'intelligent_ingestion',
                });
            });
            it('should upload file', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var chunkSize, u, res, testFile, firstPartOffset, firstPartMetadata, firstPartChunk, secondPartOffset, firstPartSecondChunk;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            chunkSize = 1024 * 1024;
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setUploadMode("intelligent" /* INTELLIGENT */);
                            u.setIntelligentChunkSize(chunkSize);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].handle).toEqual('test_handle');
                            testFile = getSmallTestFile();
                            expect(mockStart).toHaveBeenCalledWith({
                                filename: testFile.name,
                                mimetype: testFile.mimetype,
                                size: testFile.size,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                apikey: testApikey,
                                fii: true,
                            });
                            firstPartOffset = 0;
                            firstPartMetadata = testFile.getPartMetadata(0, abstract_1.INTELLIGENT_CHUNK_SIZE);
                            return [4 /*yield*/, testFile.getChunkByMetadata(firstPartMetadata, firstPartOffset, chunkSize)];
                        case 2:
                            firstPartChunk = _a.sent();
                            expect(mockUpload).toHaveBeenCalledWith({
                                md5: firstPartChunk.md5,
                                size: firstPartChunk.size,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                offset: firstPartOffset,
                                fii: true,
                                part: 1,
                            });
                            expect(mockPut).toHaveBeenCalledWith('/fakes3', expect.any(Object));
                            secondPartOffset = chunkSize;
                            return [4 /*yield*/, testFile.getChunkByMetadata(firstPartMetadata, secondPartOffset, chunkSize)];
                        case 3:
                            firstPartSecondChunk = _a.sent();
                            expect(mockUpload).toHaveBeenCalledWith({
                                md5: firstPartSecondChunk.md5,
                                size: firstPartSecondChunk.size,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                offset: secondPartOffset,
                                fii: true,
                                part: 1,
                            });
                            expect(mockPut).toHaveBeenCalledWith('/fakes3', expect.any(Object));
                            expect(mockCommit).toHaveBeenCalledWith({
                                apikey: testApikey,
                                part: 1,
                                size: testFile.size,
                                region: mockRegion,
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                            });
                            expect(mockComplete).toHaveBeenCalledWith({
                                apikey: testApikey,
                                filename: testFile.name,
                                mimetype: testFile.mimetype,
                                size: testFile.size,
                                region: mockRegion,
                                upload_id: mockUploadId,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                fii: true,
                                uri: mockedUri,
                            });
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should lower chunk size on network error', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var putRequestTimeout, delayApplied, u, res, testFile, firstPartMetadata, firstPartChunk, chunkSize, chunk1, chunk2;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            putRequestTimeout = 300;
                            delayApplied = false;
                            interceptorS3.reply(function (url, _, cb) {
                                if (!delayApplied) {
                                    delayApplied = true;
                                    setTimeout(function () {
                                        cb(504);
                                    }, 3000);
                                }
                                else {
                                    cb(null, mockPut(url, this.req.headers));
                                }
                            }, {
                                etag: 'test',
                            });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setTimeout(putRequestTimeout);
                            u.setUploadMode("intelligent" /* INTELLIGENT */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].handle).toEqual('test_handle');
                            expect(res[0].status).toEqual('test_status');
                            testFile = getSmallTestFile();
                            firstPartMetadata = testFile.getPartMetadata(0, abstract_1.INTELLIGENT_CHUNK_SIZE);
                            return [4 /*yield*/, testFile.getChunkByMetadata(firstPartMetadata, 0, abstract_1.INTELLIGENT_CHUNK_SIZE)];
                        case 2:
                            firstPartChunk = _a.sent();
                            // this request will be aborted but called on mock upload
                            expect(mockUpload).toHaveBeenNthCalledWith(1, {
                                md5: firstPartChunk.md5,
                                size: firstPartChunk.size,
                                apikey: testApikey,
                                region: mockRegion,
                                fii: true,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                offset: 0,
                                part: 1,
                            });
                            chunkSize = Math.min(abstract_1.INTELLIGENT_CHUNK_SIZE, testFile.size) / 2;
                            return [4 /*yield*/, testFile.getChunkByMetadata(firstPartMetadata, 0, chunkSize)];
                        case 3:
                            chunk1 = _a.sent();
                            expect(mockUpload).toHaveBeenNthCalledWith(2, {
                                md5: chunk1.md5,
                                size: chunk1.size,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                fii: true,
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                offset: 0,
                                part: 1,
                            });
                            return [4 /*yield*/, testFile.getChunkByMetadata(firstPartMetadata, chunkSize / 2, chunkSize)];
                        case 4:
                            chunk2 = _a.sent();
                            expect(mockUpload).toHaveBeenNthCalledWith(3, {
                                md5: chunk2.md5,
                                size: chunk2.size,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                fii: true,
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                offset: chunkSize,
                                part: 1,
                            });
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should exit when chunk size reaches min chunk size', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var u, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            interceptorS3.reply(function (url, _, cb) { return cb('Error'); });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setTimeout(100);
                            u.setUploadMode("intelligent" /* INTELLIGENT */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].status).toEqual('Failed');
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should exit on 4xx errors', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var u, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mockStart.mockReturnValue({
                                uri: mockedUri,
                                region: mockRegion,
                                upload_id: mockUploadId,
                                location_url: testHost,
                                upload_type: 'intelligent_ingestion',
                            });
                            interceptorS3.reply(400, {
                                message: 'something awful happened',
                                code: 'bad_request',
                            });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setTimeout(100);
                            u.setUploadMode("intelligent" /* INTELLIGENT */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].status).toEqual('Failed');
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should nor process upload on multipart/upload network error', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var u, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            interceptorUpload.reply(400, {
                                message: 'something awful happened',
                                code: 'bad_request',
                            });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setUploadMode("intelligent" /* INTELLIGENT */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].status).toEqual('Failed');
                            expect(mockStart).toHaveBeenCalled();
                            expect(mockPut).not.toHaveBeenCalled();
                            expect(mockCommit).not.toHaveBeenCalled();
                            expect(mockComplete).not.toHaveBeenCalled();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
        describe('Fallback mode', function () {
            it('should switch to fallback mode if regular upload fails', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var networkFail, u, res, testFile, firstPartMeta, firstPart;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mockStart.mockReturnValue({
                                uri: mockedUri,
                                region: mockRegion,
                                upload_id: mockUploadId,
                                location_url: testHost,
                                upload_type: 'intelligent_ingestion',
                            });
                            networkFail = true;
                            interceptorS3.reply(function (url, _, cb) {
                                if (networkFail) {
                                    networkFail = false;
                                    return cb('Error');
                                }
                                cb(null, mockPut(url, this.req.headers));
                            }, {
                                etag: 'test',
                            });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setUploadMode("fallback" /* FALLBACK */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].handle).toEqual('test_handle');
                            expect(res[0].status).toEqual('test_status');
                            testFile = getSmallTestFile();
                            firstPartMeta = testFile.getPartMetadata(0, abstract_1.DEFAULT_PART_SIZE);
                            return [4 /*yield*/, testFile.getPartByMetadata(firstPartMeta)];
                        case 2:
                            firstPart = _a.sent();
                            expect(mockUpload).toHaveBeenNthCalledWith(1, {
                                md5: firstPart.md5,
                                size: firstPart.size,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                uri: mockedUri,
                                upload_id: mockUploadId,
                                part: 1,
                            });
                            expect(mockUpload).toHaveBeenNthCalledWith(2, {
                                md5: firstPart.md5,
                                size: firstPart.size,
                                fii: true,
                                apikey: testApikey,
                                region: mockRegion,
                                store: {
                                    location: abstract_1.DEFAULT_STORE_LOCATION,
                                },
                                uri: mockedUri,
                                offset: 0,
                                upload_id: mockUploadId,
                                part: 1,
                            });
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should exit if intelligent ingestion is not enabled in account settings', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var networkFail, u, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mockStart.mockReturnValue({
                                uri: mockedUri,
                                region: mockRegion,
                                upload_id: mockUploadId,
                                location_url: testHost,
                            });
                            networkFail = true;
                            interceptorS3.reply(function (url, _, cb) {
                                if (networkFail) {
                                    networkFail = false;
                                    return cb({
                                        message: 'ConnectionError',
                                        code: 'ETIMEDOUT',
                                    });
                                }
                                cb(null, mockPut(url, this.req.headers));
                            }, {
                                etag: 'test',
                            });
                            u = new s3_1.S3Uploader({});
                            u.setUrl(testHost);
                            u.setApikey(testApikey);
                            u.setUploadMode("fallback" /* FALLBACK */);
                            u.addFile(getSmallTestFile());
                            return [4 /*yield*/, u.execute()];
                        case 1:
                            res = _a.sent();
                            expect(res[0].status).toEqual('Failed');
                            expect(mockCommit).not.toHaveBeenCalled();
                            expect(mockComplete).not.toHaveBeenCalled();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
    });
    describe('Regular upload', function () {
        it('should upload file', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var partSize, u, res, testFile, firstPartMeta, firstPart, secondPartMeta, secondPart;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        partSize = 1024 * 1024 * 7;
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.setPartSize(partSize);
                        u.addFile(getTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        testFile = getTestFile();
                        expect(mockStart).toHaveBeenCalledWith({
                            filename: testFile.name,
                            mimetype: testFile.mimetype,
                            size: testFile.size,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            apikey: testApikey,
                        });
                        firstPartMeta = testFile.getPartMetadata(0, partSize);
                        return [4 /*yield*/, testFile.getPartByMetadata(firstPartMeta)];
                    case 2:
                        firstPart = _a.sent();
                        expect(mockUpload).toHaveBeenNthCalledWith(1, {
                            md5: firstPart.md5,
                            size: firstPart.size,
                            apikey: testApikey,
                            region: mockRegion,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                            upload_id: mockUploadId,
                            part: 1,
                        });
                        secondPartMeta = testFile.getPartMetadata(1, partSize);
                        return [4 /*yield*/, testFile.getPartByMetadata(secondPartMeta)];
                    case 3:
                        secondPart = _a.sent();
                        expect(mockUpload).toHaveBeenNthCalledWith(2, {
                            md5: secondPart.md5,
                            size: secondPart.size,
                            apikey: testApikey,
                            region: mockRegion,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                            upload_id: mockUploadId,
                            part: 2,
                        });
                        expect(mockPut).toHaveBeenCalledWith('/fakes3', expect.any(Object));
                        expect(mockComplete).toHaveBeenCalledWith({
                            apikey: testApikey,
                            filename: testFile.name,
                            mimetype: testFile.mimetype,
                            size: testFile.size,
                            parts: [{ part_number: 1, etag: 'test' }, { part_number: 2, etag: 'test' }],
                            region: mockRegion,
                            upload_id: mockUploadId,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                        });
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        return [2 /*return*/];
                }
            });
        }); });
        it('should upload file with disable integrity check enabled', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var partSize, u, res, testFile, firstPartMeta, firstPart, secondPartMeta, secondPart;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        partSize = 1024 * 1024 * 7;
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.setPartSize(partSize);
                        u.addFile(getTestFile());
                        u.setIntegrityCheck(false);
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        testFile = getTestFile();
                        expect(mockStart).toHaveBeenCalledWith({
                            filename: testFile.name,
                            mimetype: testFile.mimetype,
                            size: testFile.size,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            apikey: testApikey,
                        });
                        firstPartMeta = testFile.getPartMetadata(0, partSize);
                        return [4 /*yield*/, testFile.getPartByMetadata(firstPartMeta)];
                    case 2:
                        firstPart = _a.sent();
                        expect(mockUpload).toHaveBeenNthCalledWith(1, {
                            size: firstPart.size,
                            apikey: testApikey,
                            region: mockRegion,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                            upload_id: mockUploadId,
                            part: 1,
                        });
                        secondPartMeta = testFile.getPartMetadata(1, partSize);
                        return [4 /*yield*/, testFile.getPartByMetadata(secondPartMeta)];
                    case 3:
                        secondPart = _a.sent();
                        expect(mockUpload).toHaveBeenNthCalledWith(2, {
                            size: secondPart.size,
                            apikey: testApikey,
                            region: mockRegion,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                            upload_id: mockUploadId,
                            part: 2,
                        });
                        expect(mockPut).toHaveBeenCalledWith('/fakes3', expect.any(Object));
                        expect(mockComplete).toHaveBeenCalledWith({
                            apikey: testApikey,
                            filename: testFile.name,
                            mimetype: testFile.mimetype,
                            size: testFile.size,
                            parts: [{ part_number: 1, etag: 'test' }, { part_number: 2, etag: 'test' }],
                            region: mockRegion,
                            upload_id: mockUploadId,
                            store: {
                                location: abstract_1.DEFAULT_STORE_LOCATION,
                            },
                            uri: mockedUri,
                        });
                        expect(res[0].handle).toEqual('test_handle');
                        expect(res[0].status).toEqual('test_status');
                        return [2 /*return*/];
                }
            });
        }); });
        it('should not process upload on multipart/upload network error', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        interceptorUpload.reply(400, {
                            message: 'something awful happened',
                            code: 'bad_request',
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('Failed');
                        expect(mockStart).toHaveBeenCalled();
                        expect(mockPut).not.toHaveBeenCalled();
                        expect(mockCommit).not.toHaveBeenCalled();
                        expect(mockComplete).not.toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should repsect retry config', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var networkFail, u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        networkFail = true;
                        nock.removeInterceptor(interceptorS3);
                        scope.persist(false);
                        interceptorS3.twice().reply(function (url, _, cb) {
                            if (networkFail) {
                                networkFail = false;
                                return cb(Error('error'));
                            }
                            cb(null, mockPut(url, this.req.headers));
                        }, { etag: 'test' });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        u.setRetryConfig({
                            retry: 1,
                            retryFactor: 2,
                            retryMaxTime: 10,
                        });
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('test_status');
                        return [2 /*return*/];
                }
            });
        }); });
    });
    describe('Common network errors', function () {
        it('should not process upload on wrong start response', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        mockStart.mockReset();
                        mockStart.mockReturnValue({
                            test: 123,
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('Failed');
                        expect(mockPut).not.toHaveBeenCalled();
                        expect(mockUpload).not.toHaveBeenCalled();
                        expect(mockCommit).not.toHaveBeenCalled();
                        expect(mockComplete).not.toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should not process upload on start error', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        interceptorStart.reply(400, {
                            message: 'something awful happened',
                            code: 'bad_request',
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('Failed');
                        expect(mockPut).not.toHaveBeenCalled();
                        expect(mockUpload).not.toHaveBeenCalled();
                        expect(mockCommit).not.toHaveBeenCalled();
                        expect(mockComplete).not.toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
        it('should nor process upload on multipart/complete network error', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
            var u, res;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        interceptorComplete.reply(400, {
                            message: 'something awful happened',
                            code: 'bad_request',
                        });
                        u = new s3_1.S3Uploader({});
                        u.setUrl(testHost);
                        u.setApikey(testApikey);
                        u.addFile(getSmallTestFile());
                        return [4 /*yield*/, u.execute()];
                    case 1:
                        res = _a.sent();
                        expect(res[0].status).toEqual('Failed');
                        expect(mockStart).toHaveBeenCalled();
                        expect(mockPut).toHaveBeenCalled();
                        expect(mockCommit).not.toHaveBeenCalled();
                        return [2 /*return*/];
                }
            });
        }); });
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvYXBpL3VwbG9hZC91cGxvYWRlcnMvczMuc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7Ozs7Ozs7OztHQWVHOzs7QUFFSCwyQkFBa0M7QUFDbEMsa0NBQWlDO0FBQ2pDLDJCQUE2QjtBQUM3Qix1Q0FBMEk7QUFDMUksc0NBQXdDO0FBRXhDLElBQU0sY0FBYyxHQUFHLElBQUksR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBQ3ZDLElBQU0sbUJBQW1CLEdBQUcsSUFBSSxHQUFHLElBQUksR0FBRyxDQUFDLENBQUM7QUFDNUMsSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQztBQUN6RSxJQUFJLGFBQWEsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztBQUV4RixJQUFJLEtBQUssQ0FBQztBQUNWLElBQUksYUFBYSxDQUFDO0FBQ2xCLElBQUksZ0JBQWdCLENBQUM7QUFDckIsSUFBSSxpQkFBaUIsQ0FBQztBQUN0QixJQUFJLGlCQUFpQixDQUFDO0FBQ3RCLElBQUksbUJBQW1CLENBQUM7QUFFeEIsSUFBTSxXQUFXLEdBQUc7SUFDbEIsT0FBQSxJQUFJLFdBQUksQ0FBQztRQUNQLEtBQUssRUFBRSxVQUFDLEtBQUssRUFBRSxHQUFHLElBQUssT0FBQSxPQUFPLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQTNDLENBQTJDO1FBQ2xFLElBQUksRUFBRSxZQUFZO1FBQ2xCLGFBQWE7UUFDYixJQUFJLEVBQUUsUUFBUSxDQUFDLE1BQU07UUFDckIsSUFBSSxFQUFFLFVBQVU7S0FDakIsQ0FBQztBQU5GLENB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ImZpbGUiOiJsaWIvYXBpL3VwbG9hZC91cGxvYWRlcnMvczMuc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTkgYnkgRmlsZXN0YWNrLlxuICogU29tZSByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFMzVXBsb2FkZXIgfSBmcm9tICcuL3MzJztcbmltcG9ydCB7IEZpbGUgfSBmcm9tICcuLy4uL2ZpbGUnO1xuaW1wb3J0ICogYXMgbm9jayBmcm9tICdub2NrJztcbmltcG9ydCB7IFVwbG9hZE1vZGUsIERFRkFVTFRfU1RPUkVfTE9DQVRJT04sIElOVEVMTElHRU5UX0NIVU5LX1NJWkUsIERFRkFVTFRfUEFSVF9TSVpFLCBJTlRFTExJR0VOVF9NT0JJTEVfQ0hVTktfU0laRSB9IGZyb20gJy4vYWJzdHJhY3QnO1xuaW1wb3J0ICogYXMgdXRpbHMgZnJvbSAnLi4vLi4vLi4vdXRpbHMnO1xuXG5jb25zdCB0ZXN0QnVmZmVyU2l6ZSA9IDEwMjQgKiAxMDI0ICogOTtcbmNvbnN0IHRlc3RTbWFsbEJ1ZmZlclNpemUgPSAxMDI0ICogMTAyNCAqIDI7XG5sZXQgdGVzdEJ1ZmYgPSBCdWZmZXIuYWxsb2ModGVzdEJ1ZmZlclNpemUpLmZpbGwoJ3QnLCAwLCB0ZXN0QnVmZmVyU2l6ZSk7XG5sZXQgc21hbGxUZXN0QnVmZiA9IEJ1ZmZlci5hbGxvYyh0ZXN0U21hbGxCdWZmZXJTaXplKS5maWxsKCd0JywgMCwgdGVzdFNtYWxsQnVmZmVyU2l6ZSk7XG5cbmxldCBzY29wZTtcbmxldCBpbnRlcmNlcHRvclMzO1xubGV0IGludGVyY2VwdG9yU3RhcnQ7XG5sZXQgaW50ZXJjZXB0b3JDb21taXQ7XG5sZXQgaW50ZXJjZXB0b3JVcGxvYWQ7XG5sZXQgaW50ZXJjZXB0b3JDb21wbGV0ZTtcblxuY29uc3QgZ2V0VGVzdEZpbGUgPSAoKSA9PlxuICBuZXcgRmlsZSh7XG4gICAgc2xpY2U6IChzdGFydCwgZW5kKSA9PiBQcm9taXNlLnJlc29sdmUodGVzdEJ1ZmYuc2xpY2Uoc3RhcnQsIGVuZCkpLFxuICAgIHR5cGU6ICd0ZXh0L3BsYWluJyxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgc2l6ZTogdGVzdEJ1ZmYubGVuZ3RoLFxuICAgIG5hbWU6ICd0ZXN0LnR4dCcsXG4gIH0pO1xuXG5jb25zdCBnZXRTbWFsbFRlc3RGaWxlID0gKCkgPT5cbiAgbmV3IEZpbGUoe1xuICAgIHNsaWNlOiAoc3RhcnQsIGVuZCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRlc3RCdWZmLnNsaWNlKHN0YXJ0LCBlbmQpKSxcbiAgICB0eXBlOiAndGV4dC9wbGFpbicsXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHNpemU6IHNtYWxsVGVzdEJ1ZmYubGVuZ3RoLFxuICAgIG5hbWU6ICd0ZXN0LnR4dCcsXG4gIH0pO1xuXG5jb25zdCBnZXROdWxsU2l6ZUZpbGUgPSAoKSA9PlxuICBuZXcgRmlsZSh7XG4gICAgc2xpY2U6IChzdGFydCwgZW5kKSA9PiBQcm9taXNlLnJlc29sdmUodGVzdEJ1ZmYuc2xpY2Uoc3RhcnQsIGVuZCkpLFxuICAgIHR5cGU6ICd0ZXh0L3BsYWluJyxcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgc2l6ZTogMCxcbiAgICBuYW1lOiAndGVzdC50eHQnLFxuICB9KTtcblxuY29uc3QgdGVzdEFwaWtleSA9ICd0ZXN0YXBpa2V5JztcbmNvbnN0IHRlc3RIb3N0ID0gJ2h0dHBzOi8vZmlsZXN0YWNrLXRlc3QuY29tJztcbmNvbnN0IG1vY2tVcGxvYWRJZCA9ICcxMjMxMzIxMjMnO1xuY29uc3QgbW9ja1JlZ2lvbiA9ICd0ZXN0LXJlZ2lvbic7XG5jb25zdCBtb2NrZWRVcmkgPSAnL3NvbWV0ZXN0JztcbmNvbnN0IHMzVXJsID0gdGVzdEhvc3QgKyAnL2Zha2VzMyc7XG5cbmNvbnN0IG1vY2tTdGFydCA9IGplc3QuZm4oKS5tb2NrTmFtZSgnbXVsdGlwYXJ0L3N0YXJ0Jyk7XG5jb25zdCBtb2NrVXBsb2FkID0gamVzdC5mbigpLm1vY2tOYW1lKCdtdWx0aXBhcnQvdXBsb2FkJyk7XG5jb25zdCBtb2NrUHV0ID0gamVzdC5mbigpLm1vY2tOYW1lKCdzMy9wdXQnKTtcbmNvbnN0IG1vY2tDb21taXQgPSBqZXN0LmZuKCkubW9ja05hbWUoJ211bHRpcGFydC9jb21taXQnKTtcbmNvbnN0IG1vY2tDb21wbGV0ZSA9IGplc3QuZm4oKS5tb2NrTmFtZSgnbXVsdGlwYXJ0L2NvbXBsZXRlJyk7XG5cbmNvbnN0IHMzQ2FsbGJhY2sgPSBmdW5jdGlvbih1cmwpIHtcbiAgcmV0dXJuIG1vY2tQdXQodXJsLCB0aGlzLnJlcS5oZWFkZXJzKTtcbn07XG5cbmRlc2NyaWJlKCdBcGkvVXBsb2FkL1VwbG9hZGVycy9TMycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgc2NvcGUgPSBub2NrKHRlc3RIb3N0KTtcbiAgICAvLyBzY29wZS5kZWZhdWx0UmVwbHlIZWFkZXJzKHsgJ2FjY2Vzcy1jb250cm9sLWFsbG93LW9yaWdpbic6ICcqJywgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9KTtcbiAgICBzY29wZS5wZXJzaXN0KCk7XG5cbiAgICBpbnRlcmNlcHRvclN0YXJ0ID0gc2NvcGUucG9zdCgnL211bHRpcGFydC9zdGFydCcpO1xuICAgIGludGVyY2VwdG9yVXBsb2FkID0gc2NvcGUucG9zdCgnL211bHRpcGFydC91cGxvYWQnKTtcbiAgICBpbnRlcmNlcHRvckNvbW1pdCA9IHNjb3BlLnBvc3QoJy9tdWx0aXBhcnQvY29tbWl0Jyk7XG4gICAgaW50ZXJjZXB0b3JDb21wbGV0ZSA9IHNjb3BlLnBvc3QoJy9tdWx0aXBhcnQvY29tcGxldGUnKTtcbiAgICBpbnRlcmNlcHRvclMzID0gc2NvcGUucHV0KCcvZmFrZXMzJyk7XG5cbiAgICBpbnRlcmNlcHRvclN0YXJ0LnJlcGx5KDIwMCwgKF8sIGRhdGEpID0+IG1vY2tTdGFydChkYXRhKSk7XG4gICAgaW50ZXJjZXB0b3JVcGxvYWQudHdpY2UoKS5yZXBseSgyMDAsIChfLCBkYXRhKSA9PiBtb2NrVXBsb2FkKGRhdGEpKTtcbiAgICBpbnRlcmNlcHRvckNvbW1pdC5yZXBseSgyMDAsIChfLCBkYXRhKSA9PiBtb2NrQ29tbWl0KGRhdGEpKTtcbiAgICBpbnRlcmNlcHRvckNvbXBsZXRlLnJlcGx5KDIwMCwgKF8sIGRhdGEpID0+IG1vY2tDb21wbGV0ZShkYXRhKSk7XG4gICAgaW50ZXJjZXB0b3JTMy50d2ljZSgpLnJlcGx5KDIwMSwgczNDYWxsYmFjaywgeyBldGFnOiAndGVzdCcgfSk7XG5cbiAgICBtb2NrU3RhcnQubW9ja1JldHVyblZhbHVlKHtcbiAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICBsb2NhdGlvbl91cmw6IHRlc3RIb3N0LFxuICAgIH0pO1xuXG4gICAgbW9ja1VwbG9hZC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgdXJsOiBzM1VybCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgdGVzdDogJ3Rlc3QnLFxuICAgICAgfSxcbiAgICAgIGxvY2F0aW9uX3VybDogdGVzdEhvc3QsXG4gICAgfSk7XG5cbiAgICBtb2NrUHV0Lm1vY2tSZXR1cm5WYWx1ZSh7fSk7XG4gICAgbW9ja0NvbW1pdC5tb2NrUmV0dXJuVmFsdWUoe30pO1xuXG4gICAgbW9ja0NvbXBsZXRlLm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICBoYW5kbGU6ICd0ZXN0X2hhbmRsZScsXG4gICAgICB1cmw6ICd0ZXN0X3VybCcsXG4gICAgICBmaWxlbmFtZTogJ3Rlc3RfZmlsZW5hbWUnLFxuICAgICAgc2l6ZTogMTIzLFxuICAgICAgbWltZXR5cGU6ICd0ZXN0X21pbWV0eXBlJyxcbiAgICAgIHN0YXR1czogJ3Rlc3Rfc3RhdHVzJyxcbiAgICAgIHVwbG9hZF90YWdzOiB7IHRlc3Q6IDEyMyB9LFxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIG5vY2suY2xlYW5BbGwoKTtcbiAgICBub2NrLmVuYWJsZU5ldENvbm5lY3QoKTtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N0YW5kYXJ0IHRlc3RzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSBjbGFzcyB3aXRob3V0IGVycm9ycycsICgpID0+IHtcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICAgIGNvbnN0IHV1ID0gbmV3IFMzVXBsb2FkZXIoe30sIDEwKTtcbiAgICAgIH0pLm5vdC50b1Rocm93RXJyb3IoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWxsb3cgYWRkaW5nIGZpbGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcbiAgICAgIHUuYWRkRmlsZShnZXRUZXN0RmlsZSgpKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGFsbG93IHRvIHNldCBtaW4gcGFydCBzaXplIGxvd2VyIHRoYW4gZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICBleHBlY3QoKCkgPT4gdS5zZXRQYXJ0U2l6ZSgxMCkpLnRvVGhyb3dFcnJvcigpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciB3aGVuIHNldHRpbmcgdG8gc21hbGwgaW50ZWxsaWdlbnQgY2h1bmsgc2l6ZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICBleHBlY3QoKCkgPT4gdS5zZXRJbnRlbGxpZ2VudENodW5rU2l6ZSgxMCkpLnRvVGhyb3dFcnJvcigpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciB3aGVuIHRyeWluZyB0byBnZXQgaG9zdCB3aGVuIGl0IGlzIHVuZGVmaW5lZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICBleHBlY3QoKCkgPT4gdS5nZXRVcmwoKSkudG9UaHJvd0Vycm9yKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNldCBpbnRlbGxpZ2VudCBtb2JpbGUgY2h1bmsgc2l6ZSBvbiBtb2JpbGUgZGV2aWNlcycsICgpID0+IHtcbiAgICAgIHNweU9uKHV0aWxzLCAnaXNNb2JpbGUnKS5hbmQucmV0dXJuVmFsdWUodHJ1ZSk7XG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgcmV0dXJuIGV4cGVjdCh1LmdldEludGVsbGlnZW50Q2h1bmtTaXplKCkpLnRvRXF1YWwoSU5URUxMSUdFTlRfTU9CSUxFX0NIVU5LX1NJWkUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhbGxvdyB0byBzZXQgcGFydCBzaXplIG9uIG90aGVyIG1vZGUgdGhhbnQgcmVndWxhcicsICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVwbG9hZE1vZGUoVXBsb2FkTW9kZS5JTlRFTExJR0VOVCk7XG5cbiAgICAgIGNvbnN0IHBhcnRTaXplID0gMTAyNCAqIDEwMjQ7XG4gICAgICB1LnNldFBhcnRTaXplKHBhcnRTaXplKTtcblxuICAgICAgZXhwZWN0KHUuZ2V0UGFydFNpemUoKSkudG9FcXVhbChERUZBVUxUX1BBUlRfU0laRSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHJ5IGNvbXBsZXRlIHJlcXVlc3Qgb24gMjAyIHN0YXR1cyBjb2RlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9jazIwMiA9IGplc3RcbiAgICAgICAgLmZuKClcbiAgICAgICAgLm1vY2tOYW1lKCcyMDIgbW9jaycpXG4gICAgICAgIC5tb2NrUmV0dXJuVmFsdWUoJycpO1xuXG4gICAgICBub2NrLnJlbW92ZUludGVyY2VwdG9yKGludGVyY2VwdG9yQ29tcGxldGUpO1xuICAgICAgc2NvcGUucGVyc2lzdChmYWxzZSk7XG4gICAgICBzY29wZS5wb3N0KCcvbXVsdGlwYXJ0L2NvbXBsZXRlJykucmVwbHkoMjAyLCAoKSA9PiBtb2NrMjAyKCkpO1xuICAgICAgc2NvcGUucG9zdCgnL211bHRpcGFydC9jb21wbGV0ZScpLnJlcGx5KDIwMCwgKF8sIGRhdGEpID0+IG1vY2tDb21wbGV0ZShkYXRhKSk7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uaGFuZGxlKS50b0VxdWFsKCd0ZXN0X2hhbmRsZScpO1xuICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ3Rlc3Rfc3RhdHVzJyk7XG5cbiAgICAgIGV4cGVjdChtb2NrMjAyKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QobW9ja0NvbXBsZXRlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3BlY3QgcHJvdmlkZWQgc3RvcmUgb3B0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0b3JlT3B0aW9uID0ge1xuICAgICAgICBjb250YWluZXI6ICd0ZXN0JyxcbiAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgIHdvcmtmbG93czogW3tcbiAgICAgICAgICBpZDogJ3Rlc3QnLFxuICAgICAgICB9XSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcihzdG9yZU9wdGlvbik7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICBhd2FpdCB1LmV4ZWN1dGUoKTtcbiAgICAgIGV4cGVjdChtb2NrU3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3RvcmU6IHN0b3JlT3B0aW9uIH0pKTtcbiAgICAgIGV4cGVjdChtb2NrQ29tcGxldGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgc3RvcmU6IHN0b3JlT3B0aW9uIH0pKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWRkIGh0dHBzIHByb3RvY29sIHRvIGxvY2F0aW9uX3VybCcsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdGFydC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgbG9jYXRpb25fdXJsOiB0ZXN0SG9zdC5yZXBsYWNlKCdodHRwczovLycsICcnKSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uaGFuZGxlKS50b0VxdWFsKCd0ZXN0X2hhbmRsZScpO1xuICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ3Rlc3Rfc3RhdHVzJyk7XG5cbiAgICAgIGV4cGVjdChtb2NrUHV0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIG9uIGZpbGUgc2l6ZSAwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N0YXJ0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICBsb2NhdGlvbl91cmw6IHRlc3RIb3N0LnJlcGxhY2UoJ2h0dHBzOi8vJywgJycpLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXROdWxsU2l6ZUZpbGUoKSk7XG5cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHUuZXhlY3V0ZSgpO1xuXG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgnRmFpbGVkJyk7XG4gICAgICBleHBlY3QobW9ja1N0YXJ0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciBvbiB3cm9uZyBldGFnIGZpZWxkJywgYXN5bmMgKGRvbmUpID0+IHtcbiAgICAgIG1vY2tTdGFydC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgbG9jYXRpb25fdXJsOiB0ZXN0SG9zdC5yZXBsYWNlKCdodHRwczovLycsICcnKSxcbiAgICAgIH0pO1xuXG4gICAgICBpbnRlcmNlcHRvclMzLm9uY2UoKS5yZXBseSgyMDAsIHMzQ2FsbGJhY2ssIHt9KTtcblxuICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcblxuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgdS5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gICAgICAgIGV4cGVjdChlcnIubWVzc2FnZSkudG9FcXVhbCgnQ2Fubm90IHVwbG9hZCBmaWxlLCBjaGVjayBTMyBidWNrZXQgc2V0dGluZ3MnKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHUuZXhlY3V0ZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhZGQgRmlsZXN0YWNrLVVwbG9hZC1SZWdpb24gaGVhZGVyIG9uIGxvY2F0aW9uX3JlZ2lvbiBwYXJhbScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tTdGFydC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgbG9jYXRpb25fcmVnaW9uOiAndGVzdCcsXG4gICAgICAgIGxvY2F0aW9uX3VybDogdGVzdEhvc3QucmVwbGFjZSgnaHR0cHM6Ly8nLCAnJyksXG4gICAgICB9KTtcblxuICAgICAgaW50ZXJjZXB0b3JVcGxvYWQucmVwbHkoMjAwLCBmdW5jdGlvbihfLCBkYXRhKSB7XG4gICAgICAgIHJldHVybiBtb2NrVXBsb2FkKGRhdGEsIHRoaXMucmVxLmhlYWRlcnMpO1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgZXhwZWN0KHJlc1swXS5oYW5kbGUpLnRvRXF1YWwoJ3Rlc3RfaGFuZGxlJyk7XG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgndGVzdF9zdGF0dXMnKTtcblxuICAgICAgY29uc3QgdGVzdEZpbGUgPSBnZXRTbWFsbFRlc3RGaWxlKCk7XG5cbiAgICAgIGNvbnN0IGZpcnN0UGFydE1ldGFkYXRhID0gdGVzdEZpbGUuZ2V0UGFydE1ldGFkYXRhKDAsIERFRkFVTFRfUEFSVF9TSVpFKTtcbiAgICAgIGNvbnN0IGZpcnN0UGFydENodW5rID0gYXdhaXQgdGVzdEZpbGUuZ2V0UGFydEJ5TWV0YWRhdGEoZmlyc3RQYXJ0TWV0YWRhdGEpO1xuXG4gICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXG4gICAgICAgIHtcbiAgICAgICAgICBtZDU6IGZpcnN0UGFydENodW5rLm1kNSxcbiAgICAgICAgICBzaXplOiB0ZXN0RmlsZS5zaXplLFxuICAgICAgICAgIGFwaWtleTogdGVzdEFwaWtleSxcbiAgICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICAgIGxvY2F0aW9uOiBERUZBVUxUX1NUT1JFX0xPQ0FUSU9OLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICAgICAgcGFydDogMSxcbiAgICAgICAgfSxcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoeyAnZmlsZXN0YWNrLXVwbG9hZC1yZWdpb24nOiAndGVzdCcgfSlcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChtb2NrUHV0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3BlY3QgcGF1c2UoKSBhbmQgcmVzdW1lKCkgY29tbWFuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRUZXN0RmlsZSgpKTtcblxuICAgICAgc2V0SW1tZWRpYXRlKCgpID0+IHUucGF1c2UoKSk7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHUucmVzdW1lKCksIDEwKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uaGFuZGxlKS50b0VxdWFsKCd0ZXN0X2hhbmRsZScpO1xuICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ3Rlc3Rfc3RhdHVzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3BlY3QgYWJvcnQoKSBjb21tYW5kJywgKGRvbmUpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRUZXN0RmlsZSgpKTtcblxuICAgICAgc2V0SW1tZWRpYXRlKCgpID0+IHUuYWJvcnQoKSk7XG4gICAgICB1LmV4ZWN1dGUoKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ0ZhaWxlZCcpO1xuICAgICAgICBkb25lKCk7XG4gICAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICAgIGRvbmUoJ0V4ZWN1dGlvbiBmYWlsZWQnKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzZW5kIGNvcnJlY3Qgc2VjdXJpdHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0U2VjdXJpdHkgPSB7XG4gICAgICAgIHBvbGljeTogJ3Rlc3RfcCcsXG4gICAgICAgIHNpZ25hdHVyZTogJ3Rlc3RfcycsXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LnNldFNlY3VyaXR5KHRlc3RTZWN1cml0eSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgndGVzdF9zdGF0dXMnKTtcblxuICAgICAgZXhwZWN0KG1vY2tTdGFydCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcodGVzdFNlY3VyaXR5KSk7XG4gICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcodGVzdFNlY3VyaXR5KSk7XG4gICAgICBleHBlY3QobW9ja0NvbXBsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh0ZXN0U2VjdXJpdHkpKTtcblxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXNwZWN0IGRpc2FibGVTdG9yYWdlS2V5IG9wdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7XG4gICAgICAgIGRpc2FibGVTdG9yYWdlS2V5OiB0cnVlLFxuICAgICAgICBwYXRoOiAnL3Rlc3QvJyxcbiAgICAgIH0pO1xuXG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCd0ZXN0X3N0YXR1cycpO1xuXG4gICAgICBjb25zdCBzdG9yYWdlS2V5RXhwZWN0ID0ge1xuICAgICAgICBzdG9yZToge1xuICAgICAgICAgIGxvY2F0aW9uOiAnczMnLFxuICAgICAgICAgIHBhdGg6ICcvdGVzdC90ZXN0LnR4dCcsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QobW9ja1N0YXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyhzdG9yYWdlS2V5RXhwZWN0KSk7XG4gICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoc3RvcmFnZUtleUV4cGVjdCkpO1xuICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoc3RvcmFnZUtleUV4cGVjdCkpO1xuXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlc3BlY3QgZGlzYWJsZVN0b3JhZ2VLZXkgb3B0aW9uIHdoZW4gcGF0aCBpcyBtaXNzaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHtcbiAgICAgICAgZGlzYWJsZVN0b3JhZ2VLZXk6IHRydWUsXG4gICAgICB9KTtcblxuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgndGVzdF9zdGF0dXMnKTtcblxuICAgICAgY29uc3Qgc3RvcmFnZUtleUV4cGVjdCA9IHtcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogJ3MzJyxcbiAgICAgICAgICBwYXRoOiAnL3Rlc3QudHh0JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGV4cGVjdChtb2NrU3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5vYmplY3RDb250YWluaW5nKHN0b3JhZ2VLZXlFeHBlY3QpKTtcbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyhzdG9yYWdlS2V5RXhwZWN0KSk7XG4gICAgICBleHBlY3QobW9ja0NvbXBsZXRlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyhzdG9yYWdlS2V5RXhwZWN0KSk7XG5cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzcGVjdCBkaXNhYmxlU3RvcmFnZUtleSBvcHRpb24gd2hlbiBwYXRoIGhhcyBtaXNzaW5nIC8nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe1xuICAgICAgICBkaXNhYmxlU3RvcmFnZUtleTogdHJ1ZSxcbiAgICAgICAgcGF0aDogJy90ZXN0JyxcbiAgICAgIH0pO1xuXG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCd0ZXN0X3N0YXR1cycpO1xuXG4gICAgICBjb25zdCBzdG9yYWdlS2V5RXhwZWN0ID0ge1xuICAgICAgICBzdG9yZToge1xuICAgICAgICAgIGxvY2F0aW9uOiAnczMnLFxuICAgICAgICAgIHBhdGg6ICcvdGVzdC90ZXN0LnR4dCcsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBleHBlY3QobW9ja1N0YXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyhzdG9yYWdlS2V5RXhwZWN0KSk7XG4gICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoc3RvcmFnZUtleUV4cGVjdCkpO1xuICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoc3RvcmFnZUtleUV4cGVjdCkpO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdUYWdzJywgKCkgPT4ge1xuICAgIGl0KCdNYWtlIGNvcnJlY3QgcmVxdWVzdCB3aXRoIHVwbG9hZCB0YWdzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHtcbiAgICAgICAgZGlzYWJsZVN0b3JhZ2VLZXk6IHRydWUsXG4gICAgICAgIHBhdGg6ICcvdGVzdCcsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdGFncyA9IHtcbiAgICAgICAgdGVzdDogJzEyMycsXG4gICAgICAgIHRlc3QyOiAndGVzdCcsXG4gICAgICB9O1xuXG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuICAgICAgdS5zZXRVcGxvYWRUYWdzKHRhZ3MpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCd0ZXN0X3N0YXR1cycpO1xuXG4gICAgICBjb25zdCB0YWdzRXhwZWN0ZWQgPSB7XG4gICAgICAgIHVwbG9hZF90YWdzOiB0YWdzLFxuICAgICAgfTtcblxuICAgICAgZXhwZWN0KHJlc1swXS51cGxvYWRUYWdzKS50b0VxdWFsKHsgdGVzdDogMTIzIH0pO1xuICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcodGFnc0V4cGVjdGVkKSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdVcGxvYWQgbW9kZXMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ0ludGVsbGlnZW50IGluZ2Vzc2lvbicsICgpID0+IHtcbiAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBtb2NrU3RhcnQubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICAgICAgbG9jYXRpb25fdXJsOiB0ZXN0SG9zdCxcbiAgICAgICAgICB1cGxvYWRfdHlwZTogJ2ludGVsbGlnZW50X2luZ2VzdGlvbicsXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdXBsb2FkIGZpbGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGNodW5rU2l6ZSA9IDEwMjQgKiAxMDI0O1xuXG4gICAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICAgIHUuc2V0VXJsKHRlc3RIb3N0KTtcbiAgICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICAgIHUuc2V0VXBsb2FkTW9kZShVcGxvYWRNb2RlLklOVEVMTElHRU5UKTtcbiAgICAgICAgdS5zZXRJbnRlbGxpZ2VudENodW5rU2l6ZShjaHVua1NpemUpO1xuICAgICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcbiAgICAgICAgZXhwZWN0KHJlc1swXS5oYW5kbGUpLnRvRXF1YWwoJ3Rlc3RfaGFuZGxlJyk7XG5cbiAgICAgICAgY29uc3QgdGVzdEZpbGUgPSBnZXRTbWFsbFRlc3RGaWxlKCk7XG4gICAgICAgIGV4cGVjdChtb2NrU3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICBmaWxlbmFtZTogdGVzdEZpbGUubmFtZSxcbiAgICAgICAgICBtaW1ldHlwZTogdGVzdEZpbGUubWltZXR5cGUsXG4gICAgICAgICAgc2l6ZTogdGVzdEZpbGUuc2l6ZSxcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgICAgZmlpOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBmaXJzdFBhcnRPZmZzZXQgPSAwO1xuICAgICAgICBjb25zdCBmaXJzdFBhcnRNZXRhZGF0YSA9IHRlc3RGaWxlLmdldFBhcnRNZXRhZGF0YSgwLCBJTlRFTExJR0VOVF9DSFVOS19TSVpFKTtcbiAgICAgICAgY29uc3QgZmlyc3RQYXJ0Q2h1bmsgPSBhd2FpdCB0ZXN0RmlsZS5nZXRDaHVua0J5TWV0YWRhdGEoZmlyc3RQYXJ0TWV0YWRhdGEsIGZpcnN0UGFydE9mZnNldCwgY2h1bmtTaXplKTtcblxuICAgICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIG1kNTogZmlyc3RQYXJ0Q2h1bmsubWQ1LFxuICAgICAgICAgIHNpemU6IGZpcnN0UGFydENodW5rLnNpemUsXG4gICAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBvZmZzZXQ6IGZpcnN0UGFydE9mZnNldCxcbiAgICAgICAgICBmaWk6IHRydWUsXG4gICAgICAgICAgcGFydDogMSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tQdXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCcvZmFrZXMzJywgZXhwZWN0LmFueShPYmplY3QpKTtcblxuICAgICAgICBjb25zdCBzZWNvbmRQYXJ0T2Zmc2V0ID0gY2h1bmtTaXplO1xuICAgICAgICBjb25zdCBmaXJzdFBhcnRTZWNvbmRDaHVuayA9IGF3YWl0IHRlc3RGaWxlLmdldENodW5rQnlNZXRhZGF0YShmaXJzdFBhcnRNZXRhZGF0YSwgc2Vjb25kUGFydE9mZnNldCwgY2h1bmtTaXplKTtcblxuICAgICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIG1kNTogZmlyc3RQYXJ0U2Vjb25kQ2h1bmsubWQ1LFxuICAgICAgICAgIHNpemU6IGZpcnN0UGFydFNlY29uZENodW5rLnNpemUsXG4gICAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBvZmZzZXQ6IHNlY29uZFBhcnRPZmZzZXQsXG4gICAgICAgICAgZmlpOiB0cnVlLFxuICAgICAgICAgIHBhcnQ6IDEsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGV4cGVjdChtb2NrUHV0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnL2Zha2VzMycsIGV4cGVjdC5hbnkoT2JqZWN0KSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tDb21taXQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgICAgcGFydDogMSxcbiAgICAgICAgICBzaXplOiB0ZXN0RmlsZS5zaXplLFxuICAgICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICAgIGFwaWtleTogdGVzdEFwaWtleSxcbiAgICAgICAgICBmaWxlbmFtZTogdGVzdEZpbGUubmFtZSxcbiAgICAgICAgICBtaW1ldHlwZTogdGVzdEZpbGUubWltZXR5cGUsXG4gICAgICAgICAgc2l6ZTogdGVzdEZpbGUuc2l6ZSxcbiAgICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICAgIGxvY2F0aW9uOiBERUZBVUxUX1NUT1JFX0xPQ0FUSU9OLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmlpOiB0cnVlLFxuICAgICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGxvd2VyIGNodW5rIHNpemUgb24gbmV0d29yayBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgcHV0UmVxdWVzdFRpbWVvdXQgPSAzMDA7XG4gICAgICAgIGxldCBkZWxheUFwcGxpZWQgPSBmYWxzZTtcblxuICAgICAgICBpbnRlcmNlcHRvclMzLnJlcGx5KFxuICAgICAgICAgIGZ1bmN0aW9uKHVybCwgXywgY2IpIHtcbiAgICAgICAgICAgIGlmICghZGVsYXlBcHBsaWVkKSB7XG4gICAgICAgICAgICAgIGRlbGF5QXBwbGllZCA9IHRydWU7XG4gICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNiKDUwNCk7XG4gICAgICAgICAgICAgIH0sIDMwMDApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY2IobnVsbCwgbW9ja1B1dCh1cmwsIHRoaXMucmVxLmhlYWRlcnMpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV0YWc6ICd0ZXN0JyxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcbiAgICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgICAgdS5zZXRUaW1lb3V0KHB1dFJlcXVlc3RUaW1lb3V0KTtcbiAgICAgICAgdS5zZXRVcGxvYWRNb2RlKFVwbG9hZE1vZGUuSU5URUxMSUdFTlQpO1xuXG4gICAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgICBleHBlY3QocmVzWzBdLmhhbmRsZSkudG9FcXVhbCgndGVzdF9oYW5kbGUnKTtcbiAgICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ3Rlc3Rfc3RhdHVzJyk7XG5cbiAgICAgICAgY29uc3QgdGVzdEZpbGUgPSBnZXRTbWFsbFRlc3RGaWxlKCk7XG4gICAgICAgIGNvbnN0IGZpcnN0UGFydE1ldGFkYXRhID0gdGVzdEZpbGUuZ2V0UGFydE1ldGFkYXRhKDAsIElOVEVMTElHRU5UX0NIVU5LX1NJWkUpO1xuICAgICAgICBjb25zdCBmaXJzdFBhcnRDaHVuayA9IGF3YWl0IHRlc3RGaWxlLmdldENodW5rQnlNZXRhZGF0YShmaXJzdFBhcnRNZXRhZGF0YSwgMCwgSU5URUxMSUdFTlRfQ0hVTktfU0laRSk7XG5cbiAgICAgICAgLy8gdGhpcyByZXF1ZXN0IHdpbGwgYmUgYWJvcnRlZCBidXQgY2FsbGVkIG9uIG1vY2sgdXBsb2FkXG4gICAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgxLCB7XG4gICAgICAgICAgbWQ1OiBmaXJzdFBhcnRDaHVuay5tZDUsXG4gICAgICAgICAgc2l6ZTogZmlyc3RQYXJ0Q2h1bmsuc2l6ZSxcbiAgICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICAgIGZpaTogdHJ1ZSxcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgcGFydDogMSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc3BsaXQgcGFydCBzaXplIGJ5IGEgaGFsZiBhbmQgcmV0cnkgcmVxdWVzdCAodGhhdHMgZ2l2ZSB1cyAyIGNodW5rcyBzbyAyIHVwbG9hZCByZXF1ZXN0cyBuZWVkZWQpXG4gICAgICAgIGNvbnN0IGNodW5rU2l6ZSA9IE1hdGgubWluKElOVEVMTElHRU5UX0NIVU5LX1NJWkUsIHRlc3RGaWxlLnNpemUpIC8gMjtcbiAgICAgICAgY29uc3QgY2h1bmsxID0gYXdhaXQgdGVzdEZpbGUuZ2V0Q2h1bmtCeU1ldGFkYXRhKGZpcnN0UGFydE1ldGFkYXRhLCAwLCBjaHVua1NpemUpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCB7XG4gICAgICAgICAgbWQ1OiBjaHVuazEubWQ1LFxuICAgICAgICAgIHNpemU6IGNodW5rMS5zaXplLFxuICAgICAgICAgIGFwaWtleTogdGVzdEFwaWtleSxcbiAgICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICAgIGxvY2F0aW9uOiBERUZBVUxUX1NUT1JFX0xPQ0FUSU9OLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZmlpOiB0cnVlLFxuICAgICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICBwYXJ0OiAxLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjaHVuazIgPSBhd2FpdCB0ZXN0RmlsZS5nZXRDaHVua0J5TWV0YWRhdGEoZmlyc3RQYXJ0TWV0YWRhdGEsIGNodW5rU2l6ZSAvIDIsIGNodW5rU2l6ZSk7XG5cbiAgICAgICAgZXhwZWN0KG1vY2tVcGxvYWQpLnRvSGF2ZUJlZW5OdGhDYWxsZWRXaXRoKDMsIHtcbiAgICAgICAgICBtZDU6IGNodW5rMi5tZDUsXG4gICAgICAgICAgc2l6ZTogY2h1bmsyLnNpemUsXG4gICAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgICBzdG9yZToge1xuICAgICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBmaWk6IHRydWUsXG4gICAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICAgICAgb2Zmc2V0OiBjaHVua1NpemUsXG4gICAgICAgICAgcGFydDogMSxcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBleGl0IHdoZW4gY2h1bmsgc2l6ZSByZWFjaGVzIG1pbiBjaHVuayBzaXplJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpbnRlcmNlcHRvclMzLnJlcGx5KCh1cmwsIF8sIGNiKSA9PiBjYignRXJyb3InKSk7XG5cbiAgICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcbiAgICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgICAgdS5zZXRUaW1lb3V0KDEwMCk7XG4gICAgICAgIHUuc2V0VXBsb2FkTW9kZShVcGxvYWRNb2RlLklOVEVMTElHRU5UKTtcblxuICAgICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG4gICAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCdGYWlsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGV4aXQgb24gNHh4IGVycm9ycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgbW9ja1N0YXJ0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICAgIGxvY2F0aW9uX3VybDogdGVzdEhvc3QsXG4gICAgICAgICAgdXBsb2FkX3R5cGU6ICdpbnRlbGxpZ2VudF9pbmdlc3Rpb24nLFxuICAgICAgICB9KTtcblxuICAgICAgICBpbnRlcmNlcHRvclMzLnJlcGx5KDQwMCwge1xuICAgICAgICAgIG1lc3NhZ2U6ICdzb21ldGhpbmcgYXdmdWwgaGFwcGVuZWQnLFxuICAgICAgICAgIGNvZGU6ICdiYWRfcmVxdWVzdCcsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICAgIHUuc2V0VXJsKHRlc3RIb3N0KTtcbiAgICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICAgIHUuc2V0VGltZW91dCgxMDApO1xuICAgICAgICB1LnNldFVwbG9hZE1vZGUoVXBsb2FkTW9kZS5JTlRFTExJR0VOVCk7XG5cbiAgICAgICAgdS5hZGRGaWxlKGdldFNtYWxsVGVzdEZpbGUoKSk7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHUuZXhlY3V0ZSgpO1xuICAgICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgnRmFpbGVkJyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBub3IgcHJvY2VzcyB1cGxvYWQgb24gbXVsdGlwYXJ0L3VwbG9hZCBuZXR3b3JrIGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBpbnRlcmNlcHRvclVwbG9hZC5yZXBseSg0MDAsIHtcbiAgICAgICAgICBtZXNzYWdlOiAnc29tZXRoaW5nIGF3ZnVsIGhhcHBlbmVkJyxcbiAgICAgICAgICBjb2RlOiAnYmFkX3JlcXVlc3QnLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICAgIHUuc2V0QXBpa2V5KHRlc3RBcGlrZXkpO1xuICAgICAgICB1LnNldFVwbG9hZE1vZGUoVXBsb2FkTW9kZS5JTlRFTExJR0VOVCk7XG4gICAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHUuZXhlY3V0ZSgpO1xuXG4gICAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCdGYWlsZWQnKTtcblxuICAgICAgICBleHBlY3QobW9ja1N0YXJ0KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICAgIGV4cGVjdChtb2NrUHV0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBleHBlY3QobW9ja0NvbW1pdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ0ZhbGxiYWNrIG1vZGUnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmYWxsYmFjayBtb2RlIGlmIHJlZ3VsYXIgdXBsb2FkIGZhaWxzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBtb2NrU3RhcnQubW9ja1JldHVyblZhbHVlKHtcbiAgICAgICAgICB1cmk6IG1vY2tlZFVyaSxcbiAgICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgICAgdXBsb2FkX2lkOiBtb2NrVXBsb2FkSWQsXG4gICAgICAgICAgbG9jYXRpb25fdXJsOiB0ZXN0SG9zdCxcbiAgICAgICAgICB1cGxvYWRfdHlwZTogJ2ludGVsbGlnZW50X2luZ2VzdGlvbicsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBuZXR3b3JrRmFpbCA9IHRydWU7XG4gICAgICAgIGludGVyY2VwdG9yUzMucmVwbHkoXG4gICAgICAgICAgZnVuY3Rpb24odXJsLCBfLCBjYikge1xuICAgICAgICAgICAgaWYgKG5ldHdvcmtGYWlsKSB7XG4gICAgICAgICAgICAgIG5ldHdvcmtGYWlsID0gZmFsc2U7XG4gICAgICAgICAgICAgIHJldHVybiBjYignRXJyb3InKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2IobnVsbCwgbW9ja1B1dCh1cmwsIHRoaXMucmVxLmhlYWRlcnMpKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV0YWc6ICd0ZXN0JyxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcbiAgICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgICAgdS5zZXRVcGxvYWRNb2RlKFVwbG9hZE1vZGUuRkFMTEJBQ0spO1xuICAgICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgICBleHBlY3QocmVzWzBdLmhhbmRsZSkudG9FcXVhbCgndGVzdF9oYW5kbGUnKTtcbiAgICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ3Rlc3Rfc3RhdHVzJyk7XG5cbiAgICAgICAgY29uc3QgdGVzdEZpbGUgPSBnZXRTbWFsbFRlc3RGaWxlKCk7XG4gICAgICAgIGNvbnN0IGZpcnN0UGFydE1ldGEgPSB0ZXN0RmlsZS5nZXRQYXJ0TWV0YWRhdGEoMCwgREVGQVVMVF9QQVJUX1NJWkUpO1xuICAgICAgICBjb25zdCBmaXJzdFBhcnQgPSBhd2FpdCB0ZXN0RmlsZS5nZXRQYXJ0QnlNZXRhZGF0YShmaXJzdFBhcnRNZXRhKTtcblxuICAgICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbk50aENhbGxlZFdpdGgoMSwge1xuICAgICAgICAgIG1kNTogZmlyc3RQYXJ0Lm1kNSxcbiAgICAgICAgICBzaXplOiBmaXJzdFBhcnQuc2l6ZSxcbiAgICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICAgIHN0b3JlOiB7XG4gICAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICAgIHBhcnQ6IDEsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCB7XG4gICAgICAgICAgbWQ1OiBmaXJzdFBhcnQubWQ1LFxuICAgICAgICAgIHNpemU6IGZpcnN0UGFydC5zaXplLFxuICAgICAgICAgIGZpaTogdHJ1ZSxcbiAgICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICAgIHN0b3JlOiB7XG4gICAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICAgIG9mZnNldDogMCxcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBwYXJ0OiAxLFxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGV4aXQgaWYgaW50ZWxsaWdlbnQgaW5nZXN0aW9uIGlzIG5vdCBlbmFibGVkIGluIGFjY291bnQgc2V0dGluZ3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIG1vY2tTdGFydC5tb2NrUmV0dXJuVmFsdWUoe1xuICAgICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgICBsb2NhdGlvbl91cmw6IHRlc3RIb3N0LFxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgbmV0d29ya0ZhaWwgPSB0cnVlO1xuICAgICAgICBpbnRlcmNlcHRvclMzLnJlcGx5KFxuICAgICAgICAgIGZ1bmN0aW9uKHVybCwgXywgY2IpIHtcbiAgICAgICAgICAgIGlmIChuZXR3b3JrRmFpbCkge1xuICAgICAgICAgICAgICBuZXR3b3JrRmFpbCA9IGZhbHNlO1xuICAgICAgICAgICAgICByZXR1cm4gY2Ioe1xuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdDb25uZWN0aW9uRXJyb3InLFxuICAgICAgICAgICAgICAgIGNvZGU6ICdFVElNRURPVVQnLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2IobnVsbCwgbW9ja1B1dCh1cmwsIHRoaXMucmVxLmhlYWRlcnMpKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGV0YWc6ICd0ZXN0JyxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgdSA9IG5ldyBTM1VwbG9hZGVyKHt9KTtcbiAgICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgICAgdS5zZXRVcGxvYWRNb2RlKFVwbG9hZE1vZGUuRkFMTEJBQ0spO1xuICAgICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgnRmFpbGVkJyk7XG4gICAgICAgIGV4cGVjdChtb2NrQ29tbWl0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgICBleHBlY3QobW9ja0NvbXBsZXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWd1bGFyIHVwbG9hZCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwbG9hZCBmaWxlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFydFNpemUgPSAxMDI0ICogMTAyNCAqIDc7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuc2V0UGFydFNpemUocGFydFNpemUpO1xuICAgICAgdS5hZGRGaWxlKGdldFRlc3RGaWxlKCkpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgY29uc3QgdGVzdEZpbGUgPSBnZXRUZXN0RmlsZSgpO1xuXG4gICAgICBleHBlY3QobW9ja1N0YXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aCh7XG4gICAgICAgIGZpbGVuYW1lOiB0ZXN0RmlsZS5uYW1lLFxuICAgICAgICBtaW1ldHlwZTogdGVzdEZpbGUubWltZXR5cGUsXG4gICAgICAgIHNpemU6IHRlc3RGaWxlLnNpemUsXG4gICAgICAgIHN0b3JlOiB7XG4gICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgIH0sXG4gICAgICAgIGFwaWtleTogdGVzdEFwaWtleSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBmaXJzdFBhcnRNZXRhID0gdGVzdEZpbGUuZ2V0UGFydE1ldGFkYXRhKDAsIHBhcnRTaXplKTtcbiAgICAgIGNvbnN0IGZpcnN0UGFydCA9IGF3YWl0IHRlc3RGaWxlLmdldFBhcnRCeU1ldGFkYXRhKGZpcnN0UGFydE1ldGEpO1xuXG4gICAgICBleHBlY3QobW9ja1VwbG9hZCkudG9IYXZlQmVlbk50aENhbGxlZFdpdGgoMSwge1xuICAgICAgICBtZDU6IGZpcnN0UGFydC5tZDUsXG4gICAgICAgIHNpemU6IGZpcnN0UGFydC5zaXplLFxuICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgfSxcbiAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICBwYXJ0OiAxLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNlY29uZFBhcnRNZXRhID0gdGVzdEZpbGUuZ2V0UGFydE1ldGFkYXRhKDEsIHBhcnRTaXplKTtcbiAgICAgIGNvbnN0IHNlY29uZFBhcnQgPSBhd2FpdCB0ZXN0RmlsZS5nZXRQYXJ0QnlNZXRhZGF0YShzZWNvbmRQYXJ0TWV0YSk7XG5cbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCB7XG4gICAgICAgIG1kNTogc2Vjb25kUGFydC5tZDUsXG4gICAgICAgIHNpemU6IHNlY29uZFBhcnQuc2l6ZSxcbiAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgIHN0b3JlOiB7XG4gICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgIH0sXG4gICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgcGFydDogMixcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1B1dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9mYWtlczMnLCBleHBlY3QuYW55KE9iamVjdCkpO1xuICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgIGZpbGVuYW1lOiB0ZXN0RmlsZS5uYW1lLFxuICAgICAgICBtaW1ldHlwZTogdGVzdEZpbGUubWltZXR5cGUsXG4gICAgICAgIHNpemU6IHRlc3RGaWxlLnNpemUsXG4gICAgICAgIHBhcnRzOiBbeyBwYXJ0X251bWJlcjogMSwgZXRhZzogJ3Rlc3QnIH0sIHsgcGFydF9udW1iZXI6IDIsIGV0YWc6ICd0ZXN0JyB9XSxcbiAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgfSxcbiAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc1swXS5oYW5kbGUpLnRvRXF1YWwoJ3Rlc3RfaGFuZGxlJyk7XG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgndGVzdF9zdGF0dXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdXBsb2FkIGZpbGUgd2l0aCBkaXNhYmxlIGludGVncml0eSBjaGVjayBlbmFibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFydFNpemUgPSAxMDI0ICogMTAyNCAqIDc7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuc2V0UGFydFNpemUocGFydFNpemUpO1xuICAgICAgdS5hZGRGaWxlKGdldFRlc3RGaWxlKCkpO1xuICAgICAgdS5zZXRJbnRlZ3JpdHlDaGVjayhmYWxzZSk7XG5cbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHUuZXhlY3V0ZSgpO1xuXG4gICAgICBjb25zdCB0ZXN0RmlsZSA9IGdldFRlc3RGaWxlKCk7XG5cbiAgICAgIGV4cGVjdChtb2NrU3RhcnQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHtcbiAgICAgICAgZmlsZW5hbWU6IHRlc3RGaWxlLm5hbWUsXG4gICAgICAgIG1pbWV0eXBlOiB0ZXN0RmlsZS5taW1ldHlwZSxcbiAgICAgICAgc2l6ZTogdGVzdEZpbGUuc2l6ZSxcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgfSxcbiAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGZpcnN0UGFydE1ldGEgPSB0ZXN0RmlsZS5nZXRQYXJ0TWV0YWRhdGEoMCwgcGFydFNpemUpO1xuICAgICAgY29uc3QgZmlyc3RQYXJ0ID0gYXdhaXQgdGVzdEZpbGUuZ2V0UGFydEJ5TWV0YWRhdGEoZmlyc3RQYXJ0TWV0YSk7XG5cbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgxLCB7XG4gICAgICAgIHNpemU6IGZpcnN0UGFydC5zaXplLFxuICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgIHJlZ2lvbjogbW9ja1JlZ2lvbixcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgfSxcbiAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICAgIHVwbG9hZF9pZDogbW9ja1VwbG9hZElkLFxuICAgICAgICBwYXJ0OiAxLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHNlY29uZFBhcnRNZXRhID0gdGVzdEZpbGUuZ2V0UGFydE1ldGFkYXRhKDEsIHBhcnRTaXplKTtcbiAgICAgIGNvbnN0IHNlY29uZFBhcnQgPSBhd2FpdCB0ZXN0RmlsZS5nZXRQYXJ0QnlNZXRhZGF0YShzZWNvbmRQYXJ0TWV0YSk7XG5cbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS50b0hhdmVCZWVuTnRoQ2FsbGVkV2l0aCgyLCB7XG4gICAgICAgIHNpemU6IHNlY29uZFBhcnQuc2l6ZSxcbiAgICAgICAgYXBpa2V5OiB0ZXN0QXBpa2V5LFxuICAgICAgICByZWdpb246IG1vY2tSZWdpb24sXG4gICAgICAgIHN0b3JlOiB7XG4gICAgICAgICAgbG9jYXRpb246IERFRkFVTFRfU1RPUkVfTE9DQVRJT04sXG4gICAgICAgIH0sXG4gICAgICAgIHVyaTogbW9ja2VkVXJpLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgcGFydDogMixcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QobW9ja1B1dCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJy9mYWtlczMnLCBleHBlY3QuYW55KE9iamVjdCkpO1xuICAgICAgZXhwZWN0KG1vY2tDb21wbGV0ZSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoe1xuICAgICAgICBhcGlrZXk6IHRlc3RBcGlrZXksXG4gICAgICAgIGZpbGVuYW1lOiB0ZXN0RmlsZS5uYW1lLFxuICAgICAgICBtaW1ldHlwZTogdGVzdEZpbGUubWltZXR5cGUsXG4gICAgICAgIHNpemU6IHRlc3RGaWxlLnNpemUsXG4gICAgICAgIHBhcnRzOiBbeyBwYXJ0X251bWJlcjogMSwgZXRhZzogJ3Rlc3QnIH0sIHsgcGFydF9udW1iZXI6IDIsIGV0YWc6ICd0ZXN0JyB9XSxcbiAgICAgICAgcmVnaW9uOiBtb2NrUmVnaW9uLFxuICAgICAgICB1cGxvYWRfaWQ6IG1vY2tVcGxvYWRJZCxcbiAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICBsb2NhdGlvbjogREVGQVVMVF9TVE9SRV9MT0NBVElPTixcbiAgICAgICAgfSxcbiAgICAgICAgdXJpOiBtb2NrZWRVcmksXG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc1swXS5oYW5kbGUpLnRvRXF1YWwoJ3Rlc3RfaGFuZGxlJyk7XG4gICAgICBleHBlY3QocmVzWzBdLnN0YXR1cykudG9FcXVhbCgndGVzdF9zdGF0dXMnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IHByb2Nlc3MgdXBsb2FkIG9uIG11bHRpcGFydC91cGxvYWQgbmV0d29yayBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGludGVyY2VwdG9yVXBsb2FkLnJlcGx5KDQwMCwge1xuICAgICAgICBtZXNzYWdlOiAnc29tZXRoaW5nIGF3ZnVsIGhhcHBlbmVkJyxcbiAgICAgICAgY29kZTogJ2JhZF9yZXF1ZXN0JyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCdGYWlsZWQnKTtcblxuICAgICAgZXhwZWN0KG1vY2tTdGFydCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tQdXQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja0NvbW1pdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrQ29tcGxldGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlcHNlY3QgcmV0cnkgY29uZmlnJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gc2ltdWxhdGUgZmlyc3QgcmVxdWVzdCBuZXR3b3JrIGZhaWxcbiAgICAgIGxldCBuZXR3b3JrRmFpbCA9IHRydWU7XG5cbiAgICAgIG5vY2sucmVtb3ZlSW50ZXJjZXB0b3IoaW50ZXJjZXB0b3JTMyk7XG4gICAgICBzY29wZS5wZXJzaXN0KGZhbHNlKTtcblxuICAgICAgaW50ZXJjZXB0b3JTMy50d2ljZSgpLnJlcGx5KFxuICAgICAgICBmdW5jdGlvbih1cmwsIF8sIGNiKSB7XG4gICAgICAgICAgaWYgKG5ldHdvcmtGYWlsKSB7XG4gICAgICAgICAgICBuZXR3b3JrRmFpbCA9IGZhbHNlO1xuICAgICAgICAgICAgcmV0dXJuIGNiKEVycm9yKCdlcnJvcicpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYihudWxsLCBtb2NrUHV0KHVybCwgdGhpcy5yZXEuaGVhZGVycykpO1xuICAgICAgICB9LFxuICAgICAgICB7IGV0YWc6ICd0ZXN0JyB9XG4gICAgICApO1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcbiAgICAgIHUuc2V0UmV0cnlDb25maWcoe1xuICAgICAgICByZXRyeTogMSxcbiAgICAgICAgcmV0cnlGYWN0b3I6IDIsXG4gICAgICAgIHJldHJ5TWF4VGltZTogMTAsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCd0ZXN0X3N0YXR1cycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29tbW9uIG5ldHdvcmsgZXJyb3JzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbm90IHByb2Nlc3MgdXBsb2FkIG9uIHdyb25nIHN0YXJ0IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgbW9ja1N0YXJ0Lm1vY2tSZXNldCgpO1xuICAgICAgbW9ja1N0YXJ0Lm1vY2tSZXR1cm5WYWx1ZSh7XG4gICAgICAgIHRlc3Q6IDEyMyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCdGYWlsZWQnKTtcbiAgICAgIGV4cGVjdChtb2NrUHV0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tVcGxvYWQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja0NvbW1pdCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrQ29tcGxldGUpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBwcm9jZXNzIHVwbG9hZCBvbiBzdGFydCBlcnJvcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGludGVyY2VwdG9yU3RhcnQucmVwbHkoNDAwLCB7XG4gICAgICAgIG1lc3NhZ2U6ICdzb21ldGhpbmcgYXdmdWwgaGFwcGVuZWQnLFxuICAgICAgICBjb2RlOiAnYmFkX3JlcXVlc3QnLFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHUgPSBuZXcgUzNVcGxvYWRlcih7fSk7XG4gICAgICB1LnNldFVybCh0ZXN0SG9zdCk7XG4gICAgICB1LnNldEFwaWtleSh0ZXN0QXBpa2V5KTtcbiAgICAgIHUuYWRkRmlsZShnZXRTbWFsbFRlc3RGaWxlKCkpO1xuXG4gICAgICBjb25zdCByZXMgPSBhd2FpdCB1LmV4ZWN1dGUoKTtcblxuICAgICAgZXhwZWN0KHJlc1swXS5zdGF0dXMpLnRvRXF1YWwoJ0ZhaWxlZCcpO1xuXG4gICAgICBleHBlY3QobW9ja1B1dCkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrVXBsb2FkKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tDb21taXQpLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QobW9ja0NvbXBsZXRlKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3IgcHJvY2VzcyB1cGxvYWQgb24gbXVsdGlwYXJ0L2NvbXBsZXRlIG5ldHdvcmsgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBpbnRlcmNlcHRvckNvbXBsZXRlLnJlcGx5KDQwMCwge1xuICAgICAgICBtZXNzYWdlOiAnc29tZXRoaW5nIGF3ZnVsIGhhcHBlbmVkJyxcbiAgICAgICAgY29kZTogJ2JhZF9yZXF1ZXN0JyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1ID0gbmV3IFMzVXBsb2FkZXIoe30pO1xuICAgICAgdS5zZXRVcmwodGVzdEhvc3QpO1xuICAgICAgdS5zZXRBcGlrZXkodGVzdEFwaWtleSk7XG4gICAgICB1LmFkZEZpbGUoZ2V0U21hbGxUZXN0RmlsZSgpKTtcblxuICAgICAgY29uc3QgcmVzID0gYXdhaXQgdS5leGVjdXRlKCk7XG5cbiAgICAgIGV4cGVjdChyZXNbMF0uc3RhdHVzKS50b0VxdWFsKCdGYWlsZWQnKTtcblxuICAgICAgZXhwZWN0KG1vY2tTdGFydCkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgICAgZXhwZWN0KG1vY2tQdXQpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIGV4cGVjdChtb2NrQ29tbWl0KS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19
